<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Belastingen en toeslagen 2026</title>
  <style>
    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      background-color: #f5f5f5;
      color: #333;
      line-height: 1.6;
      font-size: 16px;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 30px 20px;
      background: #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #003087;
      font-size: 2.4rem;
      margin-bottom: 1rem;
      font-weight: 700;
    }
    p.intro {
      font-size: 1.125rem;
      color: #444;
      margin-bottom: 2rem;
    }
    h2 {
      color: #003087;
      font-size: 1.75rem;
      margin: 2rem 0 1rem;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 0.5rem;
    }
    label {
      display: block;
      margin: 1rem 0 0.4rem;
      font-weight: 600;
      font-size: 1.05rem;
    }
    input[type="number"], select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    button {
      background-color: #003087;
      color: white;
      border: none;
      padding: 0.9rem 2rem;
      font-size: 1.1rem;
      border-radius: 4px;
      cursor: pointer;
      margin: 1.5rem 0;
    }
    button:hover {
      background-color: #002060;
    }
    #result {
      margin-top: 2rem;
      padding: 1.5rem;
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 6px;
    }
    .section {
      margin-bottom: 2.5rem;
    }
    .disclaimer {
      font-size: 0.95rem;
      color: #c00;
      background: #fff5f5;
      border: 1px solid #ffb3b3;
      padding: 1rem;
      border-radius: 4px;
      margin-top: 2rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 0.8rem;
      text-align: left;
    }
    th {
      background: #e6f0ff;
      font-weight: 600;
    }
    .hidden { display: none; }
    .child-group {
      margin-top: 1.5rem;
      padding: 1rem;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      background: #fdfdfd;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>Belastingen en toeslagen 2026</h1>
  <p class="intro">Vul hieronder de gegevens in voor een berekening van de te ontvangen of te betalen belastingen en toeslagen over 2026.</p>

  <div class="section">
    <h2>Persoonlijke situatie</h2>
    <label>Fiscaal partner?</label>
    <select id="partner" onchange="togglePartnerFields()">
      <option value="nee">Nee (alleenstaand)</option>
      <option value="ja">Ja</option>
    </select>

    <div id="partnerAges" class="hidden">
      <label>Leeftijd partner 1 (in 2026)</label>
      <input type="number" id="leeftijdPartner1" min="0" max="120" value="40">

      <label>Leeftijd partner 2 (in 2026)</label>
      <input type="number" id="leeftijdPartner2" min="0" max="120" value="40">
    </div>

    <label>Aantal kinderen onder 18 jaar</label>
    <input type="number" id="kinderen" min="0" max="10" value="0" onchange="generateChildFields()">

    <div id="childFields"></div>

    <label>WOZ-waarde woning (peildatum 1-1-2025, €)</label>
    <input type="number" id="woz" min="0" value="0">

    <label>Huurt u? (anders geen huurtoeslag)</label>
    <select id="huurt" onchange="toggleHuurSection()">
      <option value="nee">Nee</option>
      <option value="ja">Ja</option>
    </select>
  </div>

  <div class="section hidden" id="huurSection">
    <h2>Wonen & Huur</h2>
    <label>Kale huur per maand (€, excl. servicekosten)</label>
    <input type="number" id="huur" min="0" value="700">

    <label>Leeftijd hoofd-huurder</label>
    <select id="huurLeeftijd">
      <option value="onder21">Onder 21</option>
      <option value="21plus" selected>21 of ouder</option>
    </select>
  </div>

  <div class="section">
    <h2>Inkomen & Loon (box 1)</h2>
    <label>Bruto jaarloon partner 1 (€)</label>
    <input type="number" id="brutoloon1" min="0" value="40000">

    <div id="partner2Inkomen" class="hidden">
      <label>Bruto jaarloon partner 2 (€)</label>
      <input type="number" id="brutoloon2" min="0" value="0">
    </div>

    <label>Betaalde loonbelasting partner 1 (€, schatting)</label>
    <input type="number" id="loonbel1" min="0" value="8000">

    <div id="partner2Loonbel" class="hidden">
      <label>Betaalde loonbelasting partner 2 (€, schatting)</label>
      <input type="number" id="loonbel2" min="0" value="0">
    </div>

    <label>Betaalde rente hypotheek gedurende het jaar (€, totaal)</label>
    <input type="number" id="hypotheekrente" min="0" value="0">
  </div>

  <div class="section">
    <h2>Vermogen (box 3, peildatum 1 jan 2026)</h2>
    <label>Bank- & spaartegoeden (€)</label>
    <input type="number" id="spaargeld" min="0" value="10000">

    <label>Beleggingen / overig vermogen (€, aandelen, 2e huis etc.)</label>
    <input type="number" id="overigVermogen" min="0" value="0">

    <label>Schulden (niet eigenwoning, >€3.400 drempel)</label>
    <input type="number" id="schulden" min="0" value="0">
  </div>

  <button onclick="bereken()">Bereken schatting 2026</button>

  <div id="result"></div>

  <div class="disclaimer">
    <strong>Disclaimer – Dit is GEEN officiële berekening!</strong><br>
    Alleen een schatting op basis van bekende 2026-regels (jan 2026). Geen rekening met alle aftrekken, alleenstaande-ouderkorting, etc. Gebruik altijd de officiële proefberekening op <a href="https://www.belastingdienst.nl/rekenhulpen" target="_blank">belastingdienst.nl</a> of <a href="https://www.toeslagen.nl/proefberekening" target="_blank">toeslagen.nl</a>.
  </div>
</div>

<script>
// Dynamische velden
function togglePartnerFields() {
  const partner = document.getElementById('partner').value === 'ja';
  document.getElementById('partnerAges').classList.toggle('hidden', !partner);
  document.getElementById('partner2Inkomen').classList.toggle('hidden', !partner);
  document.getElementById('partner2Loonbel').classList.toggle('hidden', !partner);
}

function generateChildFields() {
  const num = parseInt(document.getElementById('kinderen').value) || 0;
  const container = document.getElementById('childFields');
  container.innerHTML = '';
  for (let i = 1; i <= num; i++) {
    const div = document.createElement('div');
    div.className = 'child-group';
    div.innerHTML = `
      <h3>Kind ${i}</h3>
      <label>Leeftijd kind ${i} (in 2026)</label>
      <input type="number" class="childLeeftijd" min="0" max="17" value="10">

      <label>Soort opvang</label>
      <select class="childOpvangType">
        <option value="dagopvang">Dagopvang (€11,23/uur)</option>
        <option value="bso">Buitenschoolse opvang (€9,98/uur)</option>
        <option value="gastouder">Gastouderopvang (€8,49/uur)</option>
      </select>

      <label>Aantal uren opvang per maand (gemiddeld)</label>
      <input type="number" class="childUren" min="0" value="0">
    `;
    container.appendChild(div);
  }
}

function toggleHuurSection() {
  const huurt = document.getElementById('huurt').value;
  document.getElementById('huurSection').classList.toggle('hidden', huurt !== 'ja');
}

// Eigenwoningforfait 2026
function berekenEigenwoningforfait(woz) {
  if (woz <= 12500) return 0;
  if (woz <= 25000) return woz * 0.0010;
  if (woz <= 50000) return woz * 0.0020;
  if (woz <= 75000) return woz * 0.0025;
  if (woz <= 1350000) return woz * 0.0035;
  return 4725 + (woz - 1350000) * 0.0235;
}

// AHK 2026
function berekenAHK(verzamel) {
  if (verzamel <= 28406) return 3068;
  if (verzamel >= 76817) return 0;
  return 3068 - 0.06337 * (verzamel - 28406);
}

// AK 2026
function berekenAK(arbeids) {
  if (arbeids <= 12169) return 0.08053 * arbeids;
  if (arbeids <= 26288) return 980 + 0.3003 * (arbeids - 12169);
  if (arbeids <= 43071) return 5220 + 0.02258 * (arbeids - 26288);
  if (arbeids <= 129078) return 5599 - 0.0651 * (arbeids - 43071);
  return 0;
}

// IACK 2026
function berekenIACK(arbeids) {
  if (arbeids <= 6145) return 0;
  if (arbeids >= 32223) return 2986;
  return 0.1145 * (arbeids - 6145);
}

// Kindgebonden budget 2026
function berekenKindgebondenBudget(aantalKinderen, toetsingsinkomen, vermogenNaSchulden, partner) {
  if (aantalKinderen === 0) return 0;

  const vrijstellingBox3 = partner ? 2 * 184633 : 184633;
  if (vermogenNaSchulden > vrijstellingBox3) return 0;

  const maxPerKind = 2580;
  let maxTotaal = aantalKinderen * maxPerKind;

  const drempel = 39141;
  let vermindering = 0;
  if (toetsingsinkomen > drempel) {
    vermindering = 0.076 * (toetsingsinkomen - drempel);
  }

  return Math.max(0, maxTotaal - vermindering);
}

// Kinderopvang percentages 2026
const percentagesTable = [
  { rangeStart: 0, rangeEnd: 24149, first: 96.0, subsequent: 96.0 },
  { rangeStart: 24150, rangeEnd: 25756, first: 96.0, subsequent: 96.0 },
  { rangeStart: 25757, rangeEnd: 27363, first: 96.0, subsequent: 96.0 },
  { rangeStart: 27364, rangeEnd: 28973, first: 96.0, subsequent: 96.0 },
  { rangeStart: 28974, rangeEnd: 30579, first: 96.0, subsequent: 96.0 },
  { rangeStart: 30580, rangeEnd: 32189, first: 96.0, subsequent: 96.0 },
  { rangeStart: 32190, rangeEnd: 33795, first: 96.0, subsequent: 96.0 },
  { rangeStart: 33796, rangeEnd: 35400, first: 96.0, subsequent: 96.0 },
  { rangeStart: 35401, rangeEnd: 37129, first: 96.0, subsequent: 96.0 },
  { rangeStart: 37130, rangeEnd: 38855, first: 96.0, subsequent: 96.0 },
  { rangeStart: 38856, rangeEnd: 40586, first: 96.0, subsequent: 96.0 },
  { rangeStart: 40587, rangeEnd: 42313, first: 96.0, subsequent: 96.0 },
  { rangeStart: 42314, rangeEnd: 44046, first: 96.0, subsequent: 96.0 },
  { rangeStart: 44047, rangeEnd: 45776, first: 96.0, subsequent: 96.0 },
  { rangeStart: 45777, rangeEnd: 47546, first: 96.0, subsequent: 96.0 },
  { rangeStart: 47547, rangeEnd: 49318, first: 96.0, subsequent: 96.0 },
  { rangeStart: 49319, rangeEnd: 51092, first: 96.0, subsequent: 96.0 },
  { rangeStart: 51093, rangeEnd: 52864, first: 96.0, subsequent: 96.0 },
  { rangeStart: 52865, rangeEnd: 54641, first: 96.0, subsequent: 96.0 },
  { rangeStart: 54642, rangeEnd: 56412, first: 96.0, subsequent: 96.0 },
  { rangeStart: 56413, rangeEnd: 58184, first: 95.5, subsequent: 95.6 },
  { rangeStart: 58185, rangeEnd: 59957, first: 94.8, subsequent: 95.6 },
  { rangeStart: 59958, rangeEnd: 61895, first: 93.9, subsequent: 95.6 },
  { rangeStart: 61896, rangeEnd: 65695, first: 92.4, subsequent: 95.6 },
  { rangeStart: 65696, rangeEnd: 69492, first: 91.6, subsequent: 95.2 },
  { rangeStart: 69493, rangeEnd: 73292, first: 90.5, subsequent: 94.6 },
  { rangeStart: 73293, rangeEnd: 77094, first: 88.2, subsequent: 94.2 },
  { rangeStart: 77095, rangeEnd: 80891, first: 85.9, subsequent: 93.9 },
  { rangeStart: 80892, rangeEnd: 84693, first: 83.7, subsequent: 93.2 },
  { rangeStart: 84694, rangeEnd: 88491, first: 81.2, subsequent: 92.7 },
  { rangeStart: 88492, rangeEnd: 92291, first: 78.9, subsequent: 92.2 },
  { rangeStart: 92292, rangeEnd: 96091, first: 76.7, subsequent: 91.5 },
  { rangeStart: 96092, rangeEnd: 99889, first: 74.3, subsequent: 90.9 },
  { rangeStart: 99890, rangeEnd: 103694, first: 72.1, subsequent: 90.5 },
  { rangeStart: 103695, rangeEnd: 107492, first: 69.6, subsequent: 90.2 },
  { rangeStart: 107493, rangeEnd: 111290, first: 67.3, subsequent: 89.5 },
  { rangeStart: 111291, rangeEnd: 115090, first: 65.1, subsequent: 89.1 },
  { rangeStart: 115091, rangeEnd: 118963, first: 62.7, subsequent: 88.6 },
  { rangeStart: 118964, rangeEnd: 122857, first: 60.6, subsequent: 87.9 },
  { rangeStart: 122858, rangeEnd: 126747, first: 58.5, subsequent: 87.4 },
  { rangeStart: 126748, rangeEnd: 130638, first: 56.4, subsequent: 87.0 },
  { rangeStart: 130639, rangeEnd: 134527, first: 54.2, subsequent: 86.7 },
  { rangeStart: 134528, rangeEnd: 138420, first: 52.3, subsequent: 86.0 },
  { rangeStart: 138421, rangeEnd: 142312, first: 50.4, subsequent: 85.4 },
  { rangeStart: 142313, rangeEnd: 146205, first: 48.5, subsequent: 85.0 },
  { rangeStart: 146206, rangeEnd: 150092, first: 46.5, subsequent: 84.4 },
  { rangeStart: 150093, rangeEnd: 153982, first: 44.5, subsequent: 84.0 },
  { rangeStart: 153983, rangeEnd: 157877, first: 42.5, subsequent: 83.3 },
  { rangeStart: 157878, rangeEnd: 161766, first: 40.5, subsequent: 82.7 },
  { rangeStart: 161767, rangeEnd: 165657, first: 38.5, subsequent: 81.7 },
  { rangeStart: 165658, rangeEnd: 169547, first: 36.5, subsequent: 81.4 },
  { rangeStart: 169548, rangeEnd: 173440, first: 36.5, subsequent: 80.6 },
  { rangeStart: 173441, rangeEnd: 177335, first: 36.5, subsequent: 79.7 },
  { rangeStart: 177336, rangeEnd: 181223, first: 36.5, subsequent: 79.1 },
  { rangeStart: 181224, rangeEnd: 185114, first: 36.5, subsequent: 78.2 },
  { rangeStart: 185115, rangeEnd: 189002, first: 36.5, subsequent: 77.7 },
  { rangeStart: 189003, rangeEnd: 192896, first: 36.5, subsequent: 76.9 },
  { rangeStart: 192897, rangeEnd: 196789, first: 36.5, subsequent: 76.2 },
  { rangeStart: 196790, rangeEnd: 200681, first: 36.5, subsequent: 75.5 },
  { rangeStart: 200682, rangeEnd: 204571, first: 36.5, subsequent: 74.5 },
  { rangeStart: 204572, rangeEnd: 208458, first: 36.5, subsequent: 74.0 },
  { rangeStart: 208459, rangeEnd: 212353, first: 36.5, subsequent: 73.3 },
  { rangeStart: 212354, rangeEnd: 216242, first: 36.5, subsequent: 72.5 },
  { rangeStart: 216243, rangeEnd: 220134, first: 36.5, subsequent: 71.8 },
  { rangeStart: 220135, rangeEnd: 224026, first: 36.5, subsequent: 71.2 },
  { rangeStart: 224027, rangeEnd: 227915, first: 36.5, subsequent: 70.4 },
  { rangeStart: 227916, rangeEnd: 231807, first: 36.5, subsequent: 69.6 },
  { rangeStart: 231808, rangeEnd: 235697, first: 36.5, subsequent: 69.1 },
  { rangeStart: 235698, rangeEnd: Infinity, first: 36.5, subsequent: 68.2 }
];

const maxHourlyRates = {
  dagopvang: 11.23,
  bso: 9.98,
  gastouder: 8.49
};

function findPercentage(toetsingsinkomen, isFirstChild) {
  for (let entry of percentagesTable) {
    if (toetsingsinkomen >= entry.rangeStart && toetsingsinkomen <= entry.rangeEnd) {
      return isFirstChild ? entry.first : entry.subsequent;
    }
  }
  return 33.0;
}

function bereken() {
  const partner = document.getElementById('partner').value === 'ja';
  const brutoloon1 = parseFloat(document.getElementById('brutoloon1').value) || 0;
  const brutoloon2 = partner ? parseFloat(document.getElementById('brutoloon2').value) || 0 : 0;
  const totaalBrutoLoon = brutoloon1 + brutoloon2;
  const loonbel1 = parseFloat(document.getElementById('loonbel1').value) || 0;
  const loonbel2 = partner ? parseFloat(document.getElementById('loonbel2').value) || 0 : 0;
  const totaalLoonbel = loonbel1 + loonbel2;
  const hypotheekrente = parseFloat(document.getElementById('hypotheekrente').value) || 0;
  const spaargeld = parseFloat(document.getElementById('spaargeld').value) || 0;
  const overig = parseFloat(document.getElementById('overigVermogen').value) || 0;
  const schulden = parseFloat(document.getElementById('schulden').value) || 0;
  const woz = parseFloat(document.getElementById('woz').value) || 0;
  const huurt = document.getElementById('huurt').value === 'ja';
  const huurMaand = huurt ? parseFloat(document.getElementById('huur').value) || 0 : 0;
  const huurLeeftijd = huurt ? document.getElementById('huurLeeftijd').value : '';
  const kinderen = parseInt(document.getElementById('kinderen').value) || 0;

  const childLeeftijden = Array.from(document.querySelectorAll('.childLeeftijd')).map(el => parseInt(el.value) || 18);
  const childOpvangTypes = Array.from(document.querySelectorAll('.childOpvangType')).map(el => el.value);
  const childUren = Array.from(document.querySelectorAll('.childUren')).map(el => parseFloat(el.value) || 0);

  const aow1 = parseInt(document.getElementById('leeftijdPartner1').value) || 0 >= 67;
  const aow2 = partner ? parseInt(document.getElementById('leeftijdPartner2').value) || 0 >= 67 : false;

  let html = '<h2>Resultaat schatting 2026</h2>';

  const eigenwoningforfait = berekenEigenwoningforfait(woz);
  const belastbaarBox1 = totaalBrutoLoon + eigenwoningforfait - hypotheekrente;

  const ibTarief1 = (aow1 || aow2) ? 0.1785 : 0.3575;
  const ibTarief2 = 0.3756;
  const ibTarief3 = 0.4950;
  const schijf1 = 38883;
  const schijf2 = 78426;

  let ib = 0;
  if (belastbaarBox1 <= schijf1) ib = belastbaarBox1 * ibTarief1;
  else if (belastbaarBox1 <= schijf2) ib = schijf1 * ibTarief1 + (belastbaarBox1 - schijf1) * ibTarief2;
  else ib = schijf1 * ibTarief1 + (schijf2 - schijf1) * ibTarief2 + (belastbaarBox1 - schijf2) * ibTarief3;

  const vrijstellingBox3 = partner ? 2 * 184633 : 184633;
  const vermogenTotaal = spaargeld + overig;
  const vermogenNaSchulden = Math.max(0, vermogenTotaal - schulden);
  let rendementsgrondslag = Math.max(0, vermogenNaSchulden - vrijstellingBox3);
  let fictRendement = (spaargeld * 0.0128) + (overig * 0.06) - (schulden * 0.027);
  let box3Inkomen = Math.max(0, fictRendement);
  let box3Belasting = box3Inkomen * 0.36;

  const verzamelTotaal = belastbaarBox1 + box3Inkomen;

  const share = partner ? 0.5 : 1;
  const verzamel1 = brutoloon1 + eigenwoningforfait * share - hypotheekrente * share + box3Inkomen * share;
  const verzamel2 = partner ? brutoloon2 + eigenwoningforfait * share - hypotheekrente * share + box3Inkomen * share : 0;

  const ahk1 = berekenAHK(verzamel1);
  const ahk2 = partner ? berekenAHK(verzamel2) : 0;
  const totalAHK = ahk1 + ahk2;

  const ak1 = berekenAK(brutoloon1);
  const ak2 = partner ? berekenAK(brutoloon2) : 0;
  const totalAK = ak1 + ak2;

  let iack = 0;
  if (childLeeftijden.some(age => age < 12)) {
    const lowestArbeids = Math.min(brutoloon1, brutoloon2 || Infinity);
    iack = berekenIACK(lowestArbeids);
  }

  const totalKortingen = totalAHK + totalAK + iack;

  const teBetalenBox1 = Math.max(0, ib - totalKortingen - totaalLoonbel);

  const toetsingsinkomenKinderopvang = belastbaarBox1;

  // Kindgebonden budget 2026
  const kgbVrijstelling = partner ? 2 * 184633 : 184633;
  let kindgebondenBudget = 0;
  if (kinderen > 0 && vermogenNaSchulden <= kgbVrijstelling) {
    const maxPerKind = 2580;
    let maxTotaal = aantalKinderen * maxPerKind;
    const drempelKGB = 39141;
    let verminderingKGB = 0;
    if (toetsingsinkomenKinderopvang > drempelKGB) {
      verminderingKGB = 0.076 * (toetsingsinkomenKinderopvang - drempelKGB);
    }
    kindgebondenBudget = Math.max(0, maxTotaal - verminderingKGB);
  }
  html += `<p><b>Kindgebonden budget schatting (jaar):</b> €${Math.round(kindgebondenBudget).toLocaleString('nl-NL')} (vermogen na schulden: €${Math.round(vermogenNaSchulden).toLocaleString('nl-NL')}, vrijstelling: €${Math.round(kgbVrijstelling).toLocaleString('nl-NL')})</p>`;

  // Zorg, huur, kinderopvang (blijft hetzelfde als eerder)

  let zorg = 0;
  let zorgMaxMaand = partner ? 246 : 129;
  let zorgGrens = partner ? 51142 : 40857;
  if (verzamelTotaal < 29500) zorg = zorgMaxMaand * 12;
  else if (verzamelTotaal < zorgGrens) {
    let afbouw = (verzamelTotaal - 29500) / (zorgGrens - 29500);
    zorg = zorgMaxMaand * 12 * (1 - afbouw * 0.8);
  }
  html += `<p><b>Zorgtoeslag schatting (jaar):</b> €${Math.round(zorg).toLocaleString('nl-NL')}</p>`;

  let huurtoeslag = 0;
  if (huurt) {
    let maxHuur = (huurLeeftijd === 'onder21') ? 498.20 : 932.93;
    let rekenHuur = Math.min(huurMaand, maxHuur);
    let huurtoeslagMaand = 0;
    if (rekenHuur > 200 && verzamelTotaal < (partner ? 60000 : 45000) + kinderen*5000) {
      huurtoeslagMaand = Math.max(0, (rekenHuur * 12 - 3000) * 0.4 - verzamelTotaal * 0.15) / 12;
    }
    huurtoeslag = huurtoeslagMaand * 12;
    html += `<p><b>Huurtoeslag schatting (jaar):</b> €${Math.round(huurtoeslag).toLocaleString('nl-NL')}</p>`;
  }

  // Kinderopvang (blijft hetzelfde, met gesorteerde uren voor first/subsequent)

  let opvangToeslag = 0;
  let opvangDetails = '<h3>Kinderopvangtoeslag details:</h3>';
  if (kinderen > 0) {
    let childData = [];
    for (let i = 0; i < kinderen; i++) {
      childData.push({
        index: i + 1,
        urenMaand: childUren[i],
        type: childOpvangTypes[i],
        leeftijd: childLeeftijden[i]
      });
    }
    childData.sort((a, b) => b.urenMaand - a.urenMaand);

    for (let i = 0; i < childData.length; i++) {
      const item = childData[i];
      const urenMaand = item.urenMaand;
      const type = item.type;
      const maxPrijsUur = maxHourlyRates[type];
      const kostenJaar = maxPrijsUur * urenMaand * 12;
      const isFirstChild = i === 0;
      const perc = findPercentage(toetsingsinkomenKinderopvang, isFirstChild) / 100;
      const toeslagChild = perc * kostenJaar;
      opvangToeslag += toeslagChild;
      opvangDetails += `<p>Kind ${item.index} (${type}, ${urenMaand} uur/maand): Max kosten €${kostenJaar.toLocaleString('nl-NL')} (perc ${perc * 100}%), toeslag €${Math.round(toeslagChild).toLocaleString('nl-NL')}</p>`;
    }
  } else {
    opvangDetails += '<p>Geen kinderen of geen opvang opgegeven.</p>';
  }
  html += opvangDetails;
  html += `<p><b>Kinderopvangtoeslag schatting (jaar, totaal):</b> €${Math.round(opvangToeslag).toLocaleString('nl-NL')}</p>`;

  let totaalToeslagen = zorg + huurtoeslag + opvangToeslag + kindgebondenBudget;
  let nettoBelasting = teBetalenBox1 + box3Belasting - totaalToeslagen;

  html += `<hr><h3>Totaaloverzicht</h3>
  <table>
    <tr><th>Omschrijving</th><th>Bedrag (€/jaar)</th></tr>
    <tr><td>Toeslagen totaal (incl. kindgebonden budget)</td><td>+${Math.round(totaalToeslagen).toLocaleString('nl-NL')}</td></tr>
    <tr><td>Belasting box 1 + 3 schatting</td><td>-${Math.round(teBetalenBox1 + box3Belasting).toLocaleString('nl-NL')}</td></tr>
    <tr><td><b>Netto schatting (belasting min toeslagen)</b></td><td><b>${Math.round(nettoBelasting).toLocaleString('nl-NL')}</b></td></tr>
  </table>`;

  document.getElementById('result').innerHTML = html;
}

// Initieel laden
window.onload = function() {
  togglePartnerFields();
  generateChildFields();
  toggleHuurSection();
};
</script>
</body>
</html>
